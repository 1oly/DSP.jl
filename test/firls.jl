using DSP

# MATLAB's firls taps generated by resample for a ratio of 3//2
h_ml = [-1.4310536619858296e-18,-0.0015218049527437325,-0.002150181141091541,3.70668154995274e-18,0.0038251740642962374,0.004906003371384393,-6.984676103395428e-18,-0.007650433134205231,-0.009357825256981775,1.1207102978491231e-17,0.013571041697501418,0.016138458533448603,-1.6173656797082727e-17,-0.022388294588697476,-0.02617147497626444,2.1551111961996462e-17,0.03540144996786277,0.04104712924920604,-2.6905432075821247e-17,-0.05516202748269346,-0.06411862191599772,3.175277024096518e-17,0.08796979026523563,0.10446069508539771,-3.56219808482348e-17,-0.15539008220258557,-0.19866928825688832,3.81188682834355e-17,0.40940847283826587,0.8249431093405478,1.0,0.8249431093405478,0.40940847283826587,3.81188682834355e-17,-0.19866928825688832,-0.15539008220258557,-3.56219808482348e-17,0.10446069508539771,0.08796979026523563,3.175277024096518e-17,-0.06411862191599772,-0.05516202748269346,-2.6905432075821247e-17,0.04104712924920604,0.03540144996786277,2.1551111961996462e-17,-0.02617147497626444,-0.022388294588697476,-1.6173656797082727e-17,0.016138458533448603,0.013571041697501418,1.1207102978491231e-17,-0.009357825256981775,-0.007650433134205231,-6.984676103395428e-18,0.004906003371384393,0.0038251740642962374,3.70668154995274e-18,-0.002150181141091541,-0.0015218049527437325,-1.4310536619858296e-18]

# Lowpass
N    = 41
b    = [(0.0, 0.4, 1), (0.6, 1, 0)]
h_lp = firls(N, b)

# Highpass
N    = 41
b    = [(0.0, 0.4, 0), (0.6, 1, 1)]
h_hp = firls(N, b)

# Bandpass
N    = 41
b    = [(0, .25, -50dBa), (.4, .6, 0dBa), (.75, 1, -50dBa)]
h_bp = firls(N, b)

# Bandstop
N    = 41
b    = [(0, .2, 0dBa), (.4, .6, -10dBa), (.8, 1, 0dBa)]
h_bs = firls(N, b)

using PyPlot

function Filters.freqz(h::Vector, w = linspace(0, π, 250))
    pr = PolynomialRatio(h, [one(eltype(h))])
    freqz(pr, w)
end
Util.amp2db(x::Complex) = amp2db(abs(x))
Util.amp2db(x::AbstractVector) = [amp2db(x) for x in x]

clf()
subplot(2,2,1)
title("Lowpass")
ylabel("dB")
xlabel("Normalized ƒ (π rad/s)")
H = amp2db(freqz(h_lp))
f = linspace(0,1, length(H))
plot(f, H)
grid()

subplot(2,2,2)
title("Highpass")
ylabel("dB")
xlabel("Normalized ƒ (π rad/s)")
H = amp2db(freqz(h_hp))
f = linspace(0,1, length(H))
plot(f, H)
grid()

subplot(2,2,3)
title("Bandpass")
ylabel("dB")
xlabel("Normalized ƒ (π rad/s)")
H = amp2db(freqz(h_bp))
f = linspace(0,1, length(H))
plot(f, H)
grid()

subplot(2,2,4)
title("Bandstop")
ylabel("dB")
xlabel("Normalized ƒ (π rad/s)")
H = amp2db(freqz(h_bs))
f = linspace(0,1, length(H))
plot(f, H)
grid()
